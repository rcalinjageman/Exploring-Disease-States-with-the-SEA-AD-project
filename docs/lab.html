<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab – Defining Disease: Exploring Single-Cell Gene Expression Associated with Alzheimer’s Disease</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c5e43376fd83cb317f8ef26ed5b8630e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="include/webex.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Defining Disease: Exploring Single-Cell Gene Expression Associated with Alzheimer’s Disease</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./news.html"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./LICENSE-CC-BY-NC-4.0.html"> 
<span class="menu-text">License</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rcalinjageman/Exploring-Disease-States-with-the-SEA-AD-project"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab.html">Lab</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pre-lab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pre-lab activity</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lab</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extensions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assessment</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="lab.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>You’ve learned about the SEA-AD database, the basics of transcriptomic (gene expression) data, and how to navigate the Cell×Gene explorer. Now, it’s time to apply that knowledge to investigate molecular changes linked to Alzheimer’s disease.</p>
<p>Our research question is: <strong>What gene expression changes are associated with Alzheimer’s disease in the microglia of the middle temporal gyrus?</strong></p>
<p>That’s a pretty focused question—so where did it come from? Here’s the background:</p>
<ul>
<li><p>Microglia have been strongly implicated in the progression of Alzheimer’s disease <span class="citation" data-cites="keren-shaul2017">(<a href="#ref-keren-shaul2017" role="doc-biblioref">Keren-Shaul et al. 2017</a>)</span></p></li>
<li><p>The middle temporal gyrus (MTG) is a brain region key to memory processing and among the first areas to show AD-related dysfunction <span class="citation" data-cites="papeo2019 chen2022">(<a href="#ref-papeo2019" role="doc-biblioref">Papeo, Agostini, and Lingnau 2019</a>; <a href="#ref-chen2022" role="doc-biblioref">Chen et al. 2022</a>)</span>.</p></li>
<li><p>The SEA-AD team’s own analysis <span class="citation" data-cites="gabitto2024">(<a href="#ref-gabitto2024" role="doc-biblioref">Gabitto et al. 2024</a>)</span> found that microglia exhibit some of the most significant gene expression changes associated with AD. This gives us a chance to explore one of their major findings firsthand.</p></li>
<li><p>By focusing only on microglia, we’ll load a smaller subset of the SEA-AD database – important because the site can be unstable or slow when handling the full dataset.</p></li>
</ul>
<section id="make-predictions" class="level3">
<h3 class="anchored" data-anchor-id="make-predictions">Make Predictions</h3>
<p>Before we begin, make some predictions about what we might find.</p>
<p><strong>Q1. The human genome contains roughly 20,000 genes. How many of these do you think might be differentially regulated</strong> – <strong>that is, showing meaningful changes in expression</strong> – <strong>in cells affected by Alzheimer’s disease?</strong></p>
<ol type="1">
<li><p><strong>One or two genes</strong></p></li>
<li><p><strong>Tens to hundreds genes</strong></p></li>
<li><p><strong>Thousands of genes</strong></p></li>
<li><p><strong>Nearly all the genes</strong></p></li>
</ol>
<p><strong>Q2: Think about the complexity of Alzheimer’s disease and the number of cellular pathways it might impact. Would you expect just a handful of genes to be involved, or a much broader shift in gene expression?</strong></p>
<p><strong>Q3. When considering the impact of Alzheimer’s disease on gene expression, how would you describe the changes you expect to see?</strong></p>
<ol type="1">
<li><p><strong>Qualitative differences – clear, distinct changes like the “on/off” pattern we saw with XIST expression.</strong></p></li>
<li><p><strong>More subtle changes – shifts in the level of expression rather than outright presence or absence, meaning the differences are a matter of degree rather than kind.</strong></p></li>
</ol>
<p><strong>Q4: Reflect on whether disease-related gene expression changes are likely to be dramatic and categorical, or more nuanced and gradual.</strong></p>
</section>
<section id="start-a-lab-notebook" class="level3">
<h3 class="anchored" data-anchor-id="start-a-lab-notebook">Start a Lab Notebook</h3>
<p>During this lab we’re going to ask you to explore a complex dataset, and as you explore we’ll ask you to take screen shots and make figures.&nbsp;&nbsp;</p>
<p>To keep a record of your work, start a single document where you can make figures (a Google Slide, a PowerPoint).&nbsp; When prompted to make figures, add each figure into this document (1 figure per page).&nbsp; Be sure to take notes or add captions to your figures so you know which figure is which.&nbsp; You can then submit a single file with all your work at the end of the lab.</p>
</section>
<section id="getting-started" class="level3">
<h3 class="anchored" data-anchor-id="getting-started">Getting started</h3>
<p>We’re going to load the SEA-AD data again, but this time we’ll focus exclusively on the <strong>microglia</strong> from the <strong>Middle Temporal Gyrus (MTG)</strong>.</p>
<p>Instead of selecting the top item on the list, scroll down near the bottom and find <strong>“Microglia-PVM-MTG: Seattle Alzheimer’s Disease Atlas (SEA-AD)”</strong>. Click <strong>Explore</strong> on that option.</p>
<p><a href="https://cellxgene.cziscience.com/collections/1ca90a2d-2943-483d-b678-b809bf464c30" class="uri">https://cellxgene.cziscience.com/collections/1ca90a2d-2943-483d-b678-b809bf464c30</a>&nbsp;</p>
<p>Make sure you select the <strong>microglia from the MTG</strong> – not the last dataset on the list, which is for the dorsolateral prefrontal cortex (DLPFC).</p>
<div id="fig-lab-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_01.png" id="fig-lab-01" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<p>You should now be in the basic SEA-AD explorer, but zoomed in to show only the microglia from the Middle Temporal Gyrus (MTG). Your UMAP will look much simpler, displaying just the microglia cluster from the larger SEA-AD dataset. Your screen will probably look something like this:</p>
<div id="fig-lab-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_02.png" id="fig-lab-02" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
<p><strong>Q5: How many individual cells are in this dataset?</strong></p>
<ol type="1">
<li><p><strong>0 cells</strong></p></li>
<li><p><strong>40,000 cells</strong></p></li>
<li><p><strong>Impossible to tell</strong></p></li>
</ol>
<p><strong>Q6: Think back to the pre-lab.&nbsp; How many individual donors are in this study?</strong></p>
<ol type="1">
<li><p><strong>Just 1, all of these cells are from one human</strong></p></li>
<li><p><strong>About 80 donors; each had many cells analyzed</strong></p></li>
<li><p><strong>About 40,000 - each donor had just 1 cell analyzed</strong></p></li>
</ol>
</section>
<section id="explore-1-gene-apoe" class="level3">
<h3 class="anchored" data-anchor-id="explore-1-gene-apoe">Explore 1 Gene: APOE</h3>
<p>Let’s start by looking for a difference in gene expression in a gene already known to be involved in Alzheimer’s Disease: APOE.</p>
<ol type="1">
<li><p>Enter APOE in the Quick Gene Search Textbox</p>
<div id="fig-lab-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_03.png" id="fig-lab-03" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3
</figcaption>
</figure>
</div></li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><p>Use the water-drop tool to color code the cells by <strong>APOE</strong> expression. Then, expand the <strong>APOE</strong> gene entry to view its overall expression histogram. Take a moment to interpret what this visualization tells you about <strong>APOE</strong> expression in microglia. What patterns or levels of expression do you notice?</p>
<div id="fig-lab-04" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_04.png" id="fig-lab-04" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4
</figcaption>
</figure>
</div></li>
</ol>
<!-- -->
<ol start="3" type="1">
<li><p>Next, investigate whether <strong>APOE</strong> expression differs in microglia from Alzheimer’s donors compared to healthy donors. Expand the <strong>disease</strong> category to reveal histograms for each group. Do the histograms look noticeably different?</p>
<div id="fig-lab-05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_05.png" id="fig-lab-05" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5
</figcaption>
</figure>
</div></li>
</ol>
<!-- -->
<ol start="4" type="1">
<li>Use the check and uncheck buttons to toggle <strong>APOE</strong> expression visualization for each group individually. Each time you switch groups, be sure to move your mouse pointer back to the UMAP to avoid unintended highlighting of other cells.</li>
</ol>
<p><strong>Q7: Based on what you see, do the expression patterns appear different between the two groups? Do these histograms seem very different to you?</strong></p>
<p><strong>Q8: Create a figure comparing the two UMAPs of normal versus AD donors. The figure should look something like what you see below. This will be Figure 1</strong></p>
<div id="fig-lab-06" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_06.png" id="fig-lab-06" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6
</figcaption>
</figure>
</div>
<p><strong>Q9: Do the APOE gene expression UMAPs look very different between microglia from Alzheimer’s donors and healthy donors?</strong></p>
<ol type="1">
<li><p><strong>Yeah, microglia from AD donors have way more APOE expression.</strong></p></li>
<li><p><strong>Yeah, microglia from AD donors have way less APOE expression.</strong></p></li>
<li><p><strong>Uhhhh… I really don’t see that much of a difference!</strong></p></li>
</ol>
<p>If you said you don’t see a huge difference, you’re right! While it would be great to download the raw data and run formal statistical tests, this difference doesn’t pass the “ocular test” – meaning it’s not an obvious change you can easily spot just by looking.</p>
</section>
<section id="test-all-the-genes" class="level3">
<h3 class="anchored" data-anchor-id="test-all-the-genes">Test *all* the genes</h3>
<p>We could keep exploring genes one by one to find those differentially expressed in microglia from AD donors, but with over 20,000 genes in the human genome, that would take ages! There has to be a better way.</p>
<p>Let’s leverage statistics and computing power to compare gene expression across every gene – one at a time – and identify those with the most statistically reliable differences.</p>
<p>To do this, we first need to define two groups in the Cell×Gene explorer: (1) microglia from healthy donors and (2) microglia from donors with Alzheimer’s disease. Once these groups are set, the explorer will handle the heavy computational work of comparing all genes between them.</p>
<p>Let’s get started!</p>
<ol type="1">
<li>Define the set of microglia from normal donors.</li>
</ol>
<p>In the “Supertype” roll down, uncheck all of the microglia supertypes, except for Micro-PVM_3_SEAAD.&nbsp; Micro-PVM3 is a disease-associated type of microglia, previously shown to undergo gene expression changes in AD (Gabitto et. al., 2024).</p>
<p><img src="images/figure_lab_07a.png" class="img-fluid"></p>
<p>In the disease roll down, uncheck the dementia box and check the <strong>normal box</strong> so that only microglia from the normal donors are selected.&nbsp; This should provide 20,124 cells.</p>
<div id="fig-lab-07" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_07.png" id="fig-lab-07" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7
</figcaption>
</figure>
</div>
<div id="fig-lab-08" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_08.png" id="fig-lab-08" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8
</figcaption>
</figure>
</div>
<p>Now, click the Population 1 button (the left “0 cells” button) – this tells the Cell×Gene explorer that this set of cells is the first set that you want to use to compare gene expression.&nbsp; You’ll see that it tells you that you’ve selected 1,900 cells for this group (Normal, Micro-PVM_3).</p>
<div id="fig-lab-09" class="quarto-float quarto-figure quarto-figure-center anchored" width="638">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_09.png" id="fig-lab-09" class="img-fluid figure-img" width="638">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9
</figcaption>
</figure>
</div>
<div id="fig-lab-10" class="quarto-float quarto-figure quarto-figure-center anchored" width="646">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_10.png" id="fig-lab-10" class="img-fluid figure-img" width="646">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10
</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>Define the set of microglia from the AD donors</li>
</ol>
<p>In the disease roll down, you’ll now check the <strong>dementia box</strong> (that’s the donors with Alzheimer’s) and uncheck the normal box.&nbsp;</p>
<div id="fig-lab-11" class="quarto-float quarto-figure quarto-figure-center anchored" width="448">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_11.png" id="fig-lab-11" class="img-fluid figure-img" width="448">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11
</figcaption>
</figure>
</div>
<p><img src="images/figure_lab_11b.png" class="img-fluid" width="304"></p>
<p>Now click the Population 2 button (be careful not to re-click the Population 1 button).&nbsp; This should lock in the 3,207 PVM-3 microglia from the Alzheimer’s donors for comparison, and it will make the comparison button turn blue. You can now ask the Cell×Gene explorer to compare gene expression across these two sets of microglia.</p>
<div id="fig-lab-12" class="quarto-float quarto-figure quarto-figure-center anchored" width="677">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_12.png" id="fig-lab-12" class="img-fluid figure-img" width="677">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12
</figcaption>
</figure>
</div>
<p><img src="images/figure_lab_12b.png" class="img-fluid" width="678"></p>
<ol start="3" type="1">
<li>Conduct the differential gene expression analysis:</li>
</ol>
<p>Click the blue <strong>Gene Expression Comparison</strong> button. The Cell×Gene explorer will process the data, which might take a moment.&nbsp;</p>
<p>Be aware – sometimes the tool crashes here, so you may need to restart if that happens.</p>
<div id="fig-lab-13" class="quarto-float quarto-figure quarto-figure-center anchored" width="587">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_13.png" id="fig-lab-13" class="img-fluid figure-img" width="587">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13
</figcaption>
</figure>
</div>
<p><img src="images/figure_lab_13b.png" class="img-fluid" width="487"></p>
<p>If all goes well, you’ll see two gene lists appear on the right side:<br>
<strong>Pop 1 high:</strong> Since Population 1 is the cells from healthy donors, this list shows genes with higher expression in normal microglia compared to Alzheimer’s microglia.<br>
<strong>Pop 2 high:</strong> This list contains genes with higher expression in microglia from Alzheimer’s disease donors.</p>
<ol start="4" type="1">
<li>Rename our output to make it easier to understand</li>
</ol>
<p>For the <strong>Pop 1 high</strong> list, click the three-dot menu (<strong>…</strong>) and select <strong>“Edit gene set name and description.”</strong> In the popup, rename it to <strong>“Lower in Alzheimer’s Microglia”</strong>&nbsp;</p>
<p>Remember, this list contains genes that are higher in microglia from healthy donors – but it’s often easier to think of them as being <strong>lower in Alzheimer’s microglia.</strong></p>
<div id="fig-lab-14" class="quarto-float quarto-figure quarto-figure-center anchored" width="510">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_14.png" id="fig-lab-14" class="img-fluid figure-img" width="510">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14
</figcaption>
</figure>
</div>
<div id="fig-lab-15" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_15.png" id="fig-lab-15" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15
</figcaption>
</figure>
</div>
<p>Now, rename the <strong>Pop 2 high</strong> list. Click the three-dot menu (<strong>…</strong>) for that list, select <strong>“Edit gene set name and description,”</strong> and in the popup, rename it to <strong>“Higher in Alzheimer’s Microglia”</strong>&nbsp;</p>
<div id="fig-lab-16" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_16.png" id="fig-lab-16" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16
</figcaption>
</figure>
</div>
<div id="fig-lab-17" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_17.png" id="fig-lab-17" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17
</figcaption>
</figure>
</div>
<p>You should now have something like this on your screen:</p>
<div id="fig-lab-18" class="quarto-float quarto-figure quarto-figure-center anchored" width="750">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_18.png" id="fig-lab-18" class="img-fluid figure-img" width="750">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18
</figcaption>
</figure>
</div>
<p><strong>What is happening when you push that button? Let’s talk about Stats!</strong></p>
<p>The Cell×Gene tool uses Welch’s t-test to identify differentially expressed genes between groups of cells. A Welch’s t-test is a statistical test used to compare the means of two independent groups, particularly when the variances of the groups are unequal. It’s an alternative to the student’s t-test (which you may have heard of), which assumes equal variances. Welch’s t-test provides a more reliable comparison when the assumption is violated.</p>
<p>We call this extensive data-profiling a <strong>screen</strong> – it means we can rapidly check for lots of possibilities to “screen” for interesting genes.&nbsp; This is a great way to discover new and unexpected things.&nbsp; It’s also an “unbiased” technique because we test *every* gene, not just the ones we already think might be important.&nbsp; The drawback, though, is that when we screen, we radically increase our risk of over-fitting – finding patterns that might have been true in this sample but which might not really generalize to all Alzheimer’s patients.&nbsp; In the full SEA-AD project, the authors took steps to avoid this issue (like checking other data sets and with other methods)</p>
<p>Thus, while a differential gene analysis is a great tool, it’s important to know that this method is useful for preliminary investigations and identifying potential markers. It’s recommended to follow up with more robust methods for formal analysis and most especially to test for the same patterns in <strong>independent samples</strong> to see if they hold up. While the Welch’s t-test is relatively fast and efficient, it may not be as accurate as other, more computationally intensive statistical tests when dealing with single-cell RNA sequencing data (e.g.&nbsp;<a href="https://pubmed.ncbi.nlm.nih.gov/25605792/">Ritchie et al., 2015</a>).</p>
</section>
<section id="explore-ptprg-one-of-the-up-regulated-genes-highlighted-by-the-sea-ad-authors" class="level3">
<h3 class="anchored" data-anchor-id="explore-ptprg-one-of-the-up-regulated-genes-highlighted-by-the-sea-ad-authors">Explore PTPRG, one of the up-regulated genes highlighted by the SEA-AD authors</h3>
<p>Let’s start with the genes up-regulated in microglia from Alzheimer’s donors. Specifically, we are going to focus in on PTPRG, one of the genes that the SEA-AD scientists highighted in their paper after doing an analysis very similar to what you just accomplished.</p>
<ul>
<li><p>Expand the “Higher in Alzheimer’s Microglia” list</p>
<div id="fig-lab-19" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_19.png" id="fig-lab-19" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19
</figcaption>
</figure>
</div></li>
</ul>
<!-- -->
<ul>
<li><p>The first gene listed is PTPRG.&nbsp; Use the eye-drop tool to color-code the UMAP for MT-ND3 expression.&nbsp; Also, expand this gene to see its overall expression histogram.</p></li>
<li><p>Explore the expression profile for MT-ND3.&nbsp; Look at its overall expression histogram.&nbsp; Think about it: What is this histogram telling you? Do all cells express this gene?</p>
<div id="fig-lab-20" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_20.png" id="fig-lab-20" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20
</figcaption>
</figure>
</div></li>
</ul>
<!-- -->
<ul>
<li><p>Compare expression between microglia from normal and AD donors:</p>
<div id="fig-lab-21" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_21.png" id="fig-lab-21" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21
</figcaption>
</figure>
</div></li>
</ul>
<!-- -->
<ul>
<li><p>Roll down the <strong>disease</strong> filter.&nbsp; Compare the by-group histograms.&nbsp; Think about it: Do they seem that different?</p></li>
<li><p>Isolate down to AD (dementia) or normal microglia, screen shot each, and line them up to compare.&nbsp;</p></li>
</ul>
<p><strong>Q.10 Be sure to label your images so you know which image comes from which group as you will be turning this in. This will be part of Figure 2.</strong>&nbsp; Your figure should end up looking something like this:</p>
<div id="fig-lab-22" class="quarto-float quarto-figure quarto-figure-center anchored" width="657">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_22.png" id="fig-lab-22" class="img-fluid figure-img" width="657">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22
</figcaption>
</figure>
</div>
<p>Think about it!</p>
<ul>
<li><p>Can you see a clear difference?&nbsp; Is it dramatic/qualitative or more a matter of degree/quantitative?&nbsp; Are all AD microglia “abnormal” (different in expression compared to control) or only some?</p></li>
<li><p>What does this gene do?&nbsp; Use the (i) information button to find out more about it. Note: information is not always available for all genes. If no info is listed, look it up here: <a href="https://www.ncbi.nlm.nih.gov/gene/" class="uri">https://www.ncbi.nlm.nih.gov/gene/</a> or here <a href="https://www.genecards.org/" class="uri">https://www.genecards.org/</a></p></li>
<li><p>What, exactly, do mitochondria do?</p></li>
</ul>
<p><strong>Q11: Write, in your own words, about the difference in expression you are seeing for PTPRG based on your created Figure 1.&nbsp; Would you call this a dramatic change in expression or a subtle change in expression?&nbsp; Does it seem like most microglia have higher expression in AD or just some?</strong></p>
</section>
<section id="explore-other-up-regulated-genes" class="level3">
<h3 class="anchored" data-anchor-id="explore-other-up-regulated-genes">Explore Other Up-Regulated Genes</h3>
<p>Keep exploring the up-regulated list.&nbsp; Go on to the 1st and 2nd most up-regulated (MT-ND3, MT-ATP6) and create another figure comparing gene expression differences between normal and AD. What happens to the degree of difference as you work through the list?&nbsp; Do the differences get more noticeable or less?&nbsp; Why?&nbsp; How far down the list before you don’t really feel confident about a difference?&nbsp;</p>
<p><strong>Q13: Based on your inspection of the list, write a short overall summary in your own words.&nbsp; Try to express yourself clearly and succinctly (briefly) and without jargon. Your paragraph should help another reader understand:</strong></p>
<ul>
<li><p><strong>What is the association between AD and gene expression in MTG microglia?</strong></p></li>
<li><p><strong>Are there widespread differences or are they more subtle?</strong></p></li>
</ul>
<p><strong>Q14: So we will have it for later, write down the top 10 up-regulated genes.&nbsp; This would work best in a spreadsheet (Excel or Google Sheets).&nbsp; Be sure to label what your list is.</strong> &nbsp;</p>
<p>Note: The gene names are sometimes cut off in the Cell×Gene explorer, but if you hover over the name you’ll get the whole thing:</p>
<div id="fig-lab-23" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lab-23-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/figure_lab_23.png" id="fig-lab-23" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-lab-23-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;23
</figcaption>
</figure>
</div>
</section>
<section id="explore-the-most-down-regulated-genes" class="level3">
<h3 class="anchored" data-anchor-id="explore-the-most-down-regulated-genes">Explore the Most Down-Regulated Genes</h3>
<p>Now explore the down-regulated genes:</p>
<ul>
<li><p>Browse through the list</p></li>
<li><p>Make specific gene expression comparison figures (well labelled) for the <strong>top two down-regulated genes</strong></p></li>
<li><p>Work down the list to where you no longer feel very confident about the differences, though you don’t have to make figures past the first two genes</p></li>
</ul>
<p><strong>Q15: Be sure to label your images so you know which image comes from which group as you will be turning this in. This will be the Figure 3 comparing the top two down-regulated genes</strong></p>
<p><strong>Q16: Write up a short paragraph summarizing your exploration of the down-regulated genes</strong></p>
<p><strong>Q17: So we’ll have it for later, also write down the names of the top 10 down-regulated genes.&nbsp; Write this down as an additional list in the spreadsheet where you wrote down the top 10 up-regulated genes.</strong></p>
</section>
<section id="your-lab-hand-in-so-far" class="level3">
<h3 class="anchored" data-anchor-id="your-lab-hand-in-so-far">Your Lab Hand-In So Far</h3>
<p><strong>You should now have:</strong></p>
<ol type="1">
<li><p><strong>Figure 1: A figure comparing APOE expression in the microglia from normal and AD donors (Q8)</strong></p></li>
<li><p><strong>Figure 2: A figure comparing the PTPRG between normal and AD donors (Q10, Q12)</strong></p></li>
<li><p><strong>A short paragraph summarizing your analysis of the up-regulated genes (Q11, Q13)</strong></p></li>
<li><p><strong>A multipanel figure comparing the top two down-regulated genes (P2RY12 and CX3CR1) between normal and AD donors (Q15)</strong></p></li>
<li><p><strong>A short paragraph summarizing your analysis of the down-regulated genes (Q16)</strong></p></li>
<li><p><strong>A spreadsheet with 2 labelled lists: the top 10 most up-regulated genes and the top 10 most down-regulated genes. (Q14, Q17)</strong></p></li>
</ol>
</section>
<section id="thinking-critically-about-confounds" class="level3">
<h3 class="anchored" data-anchor-id="thinking-critically-about-confounds">Thinking Critically About Confounds</h3>
<p>This is a correlational study – donors were not assigned to have AD (thank goodness!).&nbsp; But that means we have to be especially worried about confounds – other ways in which these participants/cells might differ beyond AD status.&nbsp;&nbsp;</p>
<p>For example, in the control group, there are 5 female and 4 male donors (55% female).&nbsp; But in the AD group there are 46 female&nbsp; and 29 male donors (61% female).&nbsp; That means that the AD group is not really the same as the control group – females are over-represented.&nbsp; And that means that what we think is an AD difference might actually just be a sex difference.&nbsp; Uh oh!&nbsp;&nbsp;</p>
<p>We can check this worry – we can look at if our top genes that differ by AD seem to differ by sex as well.</p>
<p><strong>Examine if expression of PTPRG differs in the microglia of control males and females:</strong></p>
<ul>
<li><p>In the disease drop down, check normal only</p></li>
<li><p>Color code by PTPRG</p></li>
<li><p>Then in the sex drop-down, check males only and then females only, again screen shot-ing each group on their own and making a figure for side-by-side comparison.</p></li>
</ul>
<p><strong>Q18: Within these normal donors, does it look like females express more PTPRG in their microglia? Why is the fact that this seems so similar good news?</strong></p>
</section>
<section id="wrapping-up-some-things-to-think-about" class="level3">
<h3 class="anchored" data-anchor-id="wrapping-up-some-things-to-think-about">Wrapping up: Some things to think about</h3>
<ul>
<li><p>We saw that the comparison of Alzheimer’s Disease and normal cells was confounded by sex (the AD group had a lot higher proportion of females than the control group). Think about it: How do you think the original researchers of the SEA-AD project dealt with this issue?</p></li>
<li><p>The SEA-AD project sequenced over 1.2 million cells.&nbsp; But these came from only 84 individual donors.&nbsp; What, really, is the sample size?&nbsp; Normally when we have millions of data points we can feel pretty confident about results generalizing, but should we be more cautious here?&nbsp; Why?</p></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-chen2022" class="csl-entry" role="listitem">
Chen, Shuo, Yuzhou Chang, Liangping Li, Diana Acosta, Yang Li, Qi Guo, Cankun Wang, et al. 2022. <span>“Spatially Resolved Transcriptomics Reveals Genes Associated with the Vulnerability of Middle Temporal Gyrus in Alzheimer<span>’</span>s Disease.”</span> <em>Acta Neuropathologica Communications</em> 10 (1): 188. <a href="https://doi.org/10.1186/s40478-022-01494-6">https://doi.org/10.1186/s40478-022-01494-6</a>.
</div>
<div id="ref-gabitto2024" class="csl-entry" role="listitem">
Gabitto, Mariano I., Kyle J. Travaglini, Victoria M. Rachleff, Eitan S. Kaplan, Brian Long, Jeanelle Ariza, Yi Ding, et al. 2024. <span>“Integrated Multimodal Cell Atlas of Alzheimer<span>’</span>s Disease.”</span> <em>Nature Neuroscience</em> 27 (12): 2366–83. <a href="https://doi.org/10.1038/s41593-024-01774-5">https://doi.org/10.1038/s41593-024-01774-5</a>.
</div>
<div id="ref-keren-shaul2017" class="csl-entry" role="listitem">
Keren-Shaul, Hadas, Amit Spinrad, Assaf Weiner, Orit Matcovitch-Natan, Raz Dvir-Szternfeld, Tyler K. Ulland, Eyal David, et al. 2017. <span>“A Unique Microglia Type Associated with Restricting Development of Alzheimer<span>’</span>s Disease.”</span> <em>Cell</em> 169 (7): 1276–1290.e17. <a href="https://doi.org/10.1016/j.cell.2017.05.018">https://doi.org/10.1016/j.cell.2017.05.018</a>.
</div>
<div id="ref-papeo2019" class="csl-entry" role="listitem">
Papeo, Liuba, Beatrice Agostini, and Angelika Lingnau. 2019. <span>“The Large-Scale Organization of Gestures and Words in the Middle Temporal Gyrus.”</span> <em>Journal of Neuroscience</em> 39 (30): 5966–74. <a href="https://doi.org/10.1523/JNEUROSCI.2668-18.2019">https://doi.org/10.1523/JNEUROSCI.2668-18.2019</a>.
</div>
</div></section></div></main> <!-- /main -->
<script>



/* update total correct if #webex-total_correct exists */

update_total_correct = function() {

  console.log("webex: update total_correct");



  var t = document.getElementsByClassName("webex-total_correct");

  for (var i = 0; i < t.length; i++) {

    p = t[i].parentElement;

    var correct = p.getElementsByClassName("webex-correct").length;

    var solvemes = p.getElementsByClassName("webex-solveme").length;

    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;

    var selects = p.getElementsByClassName("webex-select").length;



    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";

  }

}



/* webex-solution button toggling function */

b_func = function() {

  console.log("webex: toggle hide");



  var cl = this.parentElement.classList;

  if (cl.contains('open')) {

    cl.remove("open");

  } else {

    cl.add("open");

  }

}



/* check answers */

check_func = function() {

  console.log("webex: check answers");



  var cl = this.parentElement.classList;

  if (cl.contains('unchecked')) {

    cl.remove("unchecked");

    this.innerHTML = "Hide Answers";

  } else {

    cl.add("unchecked");

    this.innerHTML = "Show Answers";

  }

}



/* function for checking solveme answers */

solveme_func = function(e) {

  console.log("webex: check solveme");



  var real_answers = JSON.parse(this.dataset.answer);

  var my_answer = this.value;

  var cl = this.classList;

  if (cl.contains("ignorecase")) {

    my_answer = my_answer.toLowerCase();

  }

  if (cl.contains("nospaces")) {

    my_answer = my_answer.replace(/ /g, "")

  }



  if (my_answer == "") {

    cl.remove("webex-correct");

    cl.remove("webex-incorrect");

  } else if (real_answers.includes(my_answer)) {

    cl.add("webex-correct");

    cl.remove("webex-incorrect");

  } else {

    cl.add("webex-incorrect");

    cl.remove("webex-correct");

  }



  // match numeric answers within a specified tolerance

  if(this.dataset.tol > 0){

    var tol = JSON.parse(this.dataset.tol);

    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)

    if (matches.reduce((a, b) => a + b, 0) > 0) {

      cl.add("webex-correct");

    } else {

      cl.remove("webex-correct");

    }

  }



  // added regex bit

  if (cl.contains("regex")){

    answer_regex = RegExp(real_answers.join("|"))

    if (answer_regex.test(my_answer)) {

      cl.add("webex-correct");

    }

  }



  update_total_correct();

}



/* function for checking select answers */

select_func = function(e) {

  console.log("webex: check select");



  var cl = this.classList



  /* add style */

  cl.remove("webex-incorrect");

  cl.remove("webex-correct");

  if (this.value == "answer") {

    cl.add("webex-correct");

  } else if (this.value != "blank") {

    cl.add("webex-incorrect");

  }



  update_total_correct();

}



/* function for checking radiogroups answers */

radiogroups_func = function(e) {

  console.log("webex: check radiogroups");



  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');

  var cl = checked_button.parentElement.classList;

  var labels = checked_button.parentElement.parentElement.children;



  /* get rid of styles */

  for (i = 0; i < labels.length; i++) {

    labels[i].classList.remove("webex-incorrect");

    labels[i].classList.remove("webex-correct");

  }



  /* add style */

  if (checked_button.value == "answer") {

    cl.add("webex-correct");

  } else {

    cl.add("webex-incorrect");

  }



  update_total_correct();

}



window.onload = function() {

  console.log("webex onload");

  /* set up solution buttons */

  var buttons = document.getElementsByTagName("button");



  for (var i = 0; i < buttons.length; i++) {

    if (buttons[i].parentElement.classList.contains('webex-solution')) {

      buttons[i].onclick = b_func;

    }

  }



  var check_sections = document.getElementsByClassName("webex-check");

  console.log("check:", check_sections.length);

  for (var i = 0; i < check_sections.length; i++) {

    check_sections[i].classList.add("unchecked");



    let btn = document.createElement("button");

    btn.innerHTML = "Show Answers";

    btn.classList.add("webex-check-button");

    btn.onclick = check_func;

    check_sections[i].appendChild(btn);



    let spn = document.createElement("span");

    spn.classList.add("webex-total_correct");

    check_sections[i].appendChild(spn);

  }



  /* set up webex-solveme inputs */

  var solveme = document.getElementsByClassName("webex-solveme");



  for (var i = 0; i < solveme.length; i++) {

    /* make sure input boxes don't auto-anything */

    solveme[i].setAttribute("autocomplete","off");

    solveme[i].setAttribute("autocorrect", "off");

    solveme[i].setAttribute("autocapitalize", "off");

    solveme[i].setAttribute("spellcheck", "false");

    solveme[i].value = "";



    /* adjust answer for ignorecase or nospaces */

    var cl = solveme[i].classList;

    var real_answer = solveme[i].dataset.answer;

    if (cl.contains("ignorecase")) {

      real_answer = real_answer.toLowerCase();

    }

    if (cl.contains("nospaces")) {

      real_answer = real_answer.replace(/ /g, "");

    }

    solveme[i].dataset.answer = real_answer;



    /* attach checking function */

    solveme[i].onkeyup = solveme_func;

    solveme[i].onchange = solveme_func;



    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")

  }



  /* set up radiogroups */

  var radiogroups = document.getElementsByClassName("webex-radiogroup");

  for (var i = 0; i < radiogroups.length; i++) {

    radiogroups[i].onchange = radiogroups_func;

  }



  /* set up selects */

  var selects = document.getElementsByClassName("webex-select");

  for (var i = 0; i < selects.length; i++) {

    selects[i].onchange = select_func;

    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")

  }



  update_total_correct();

}



</script>

<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>